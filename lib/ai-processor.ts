"use client"

import { GeminiService } from "./gemini-service"
import { VisualStudioService } from "./visual-studio-service"
import { MindMapGenerator } from "./mind-map-generator"
import { memoize } from "./performance-utils"

/**
 * ูุนุงูุฌ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุญุณู
 * ูุชุนุงูู ูุน ูุนุงูุฌุฉ ุงุณุชุนูุงูุงุช ุงููุณุชุฎุฏู ูุชูููุฏ ุงูุงุณุชุฌุงุจุงุช
 * ูุน ุงูุชูุงูู ูุน Google Gemini ูุชุญุณูู ุงูุชูุณูู
 */

export class AIProcessor {
  private personality = "neutral"
  private useGemini = true
  private useDeepThinking = true
  private useWebResearch = true
  private useVisualStudio = true
  private useMindMaps = true
  private geminiService: GeminiService
  private visualStudioService: VisualStudioService
  private mindMapGenerator: MindMapGenerator
  private cache: Map<string, any> = new Map()
  private processingQueue: Array<() => Promise<void>> = []
  private isProcessing = false
  private maxConcurrentProcessing = 2

  constructor() {
    // ุชุญููู ุดุฎุตูุฉ ุงูุจูุช ุงููุญููุธุฉ ุฅุฐุง ูุงูุช ูุชููุฑุฉ
    if (typeof window !== "undefined") {
      const savedPersonality = localStorage.getItem("botPersonality")
      if (savedPersonality) {
        this.personality = savedPersonality
      }

      // ุชุญููู ุฅุนุฏุงุฏุงุช ุงูุชูุงูู
      const geminiEnabled = localStorage.getItem("geminiEnabled")
      if (geminiEnabled !== null) {
        this.useGemini = geminiEnabled === "true"
      }

      const deepThinkingEnabled = localStorage.getItem("deepThinkingEnabled")
      if (deepThinkingEnabled !== null) {
        this.useDeepThinking = deepThinkingEnabled === "true"
      }

      const webResearchEnabled = localStorage.getItem("webResearchEnabled")
      if (webResearchEnabled !== null) {
        this.useWebResearch = webResearchEnabled === "true"
      }

      const visualStudioEnabled = localStorage.getItem("visualStudioEnabled")
      if (visualStudioEnabled !== null) {
        this.useVisualStudio = visualStudioEnabled === "true"
      }

      const mindMapsEnabled = localStorage.getItem("mindMapsEnabled")
      if (mindMapsEnabled !== null) {
        this.useMindMaps = mindMapsEnabled === "true"
      }
    }

    // ุชููุฆุฉ ุงูุฎุฏูุงุช
    this.geminiService = new GeminiService()
    this.visualStudioService = new VisualStudioService()
    this.mindMapGenerator = new MindMapGenerator()

    // ุชุญุณูู ุงูุฃุฏุงุก: ุงุณุชุฎุฏุงู memoize ูููุธุงุฆู ุงููุชูุฑุฑุฉ
    this.analyzeQueryType = memoize(this.analyzeQueryType.bind(this))
    this.cleanResponseFormatting = memoize(this.cleanResponseFormatting.bind(this))
  }

  /**
   * ูุนุงูุฌุฉ ุงุณุชุนูุงู ุงููุณุชุฎุฏู ูุชูููุฏ ุงุณุชุฌุงุจุฉ
   */
  async processQuery(query: string): Promise<string> {
    // ุงูุชุญูู ูู ูุฌูุฏ ุงูุงุณุชุนูุงู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
    const cacheKey = `query_${this.personality}_${query}`
    if (this.cache.has(cacheKey)) {
      console.log("ุงุณุชุฎุฏุงู ุงูุงุณุชุฌุงุจุฉ ุงููุฎุฒูุฉ ูุคูุชูุง")
      return this.cache.get(cacheKey)
    }

    // ุฅุถุงูุฉ ุงููููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
    return new Promise<string>((resolve) => {
      this.processingQueue.push(async () => {
        try {
          // ูุญุงูุงุฉ ููุช ุงููุนุงูุฌุฉ
          await new Promise((r) => setTimeout(r, 1500))

          // ุงุณุชุฎุฏุงู Google Gemini ุฅุฐุง ูุงู ููุนูุงู
          if (this.useGemini) {
            try {
              console.log("ุงุณุชุฎุฏุงู Google Gemini ููุนุงูุฌุฉ ุงูุงุณุชุนูุงู")

              // ุฅุถุงูุฉ ุชูุฌูู ุงููุธุงู ุจูุงุกู ุนูู ุดุฎุตูุฉ ุงูุจูุช
              const systemPrompt = `
              ${this.getSystemPromptForPersonality()}
              
              # ุฅุฑุดุงุฏุงุช ุงูุชูุณูู
              - ุงุณุชุฎุฏู ุนูุงููู ูุงุถุญุฉ ูุน ุนูุงูุงุช # ู ## ููุชูุธูู
              - ูุณู ุงููุญุชูู ุฅูู ููุฑุงุช ูุตูุฑุฉ ููุฑูุฒุฉ
              - ุงุณุชุฎุฏู ููุงุฆู ูุฑููุฉ ููุฎุทูุงุช ูุงูุฅุฌุฑุงุกุงุช
              - ุงุณุชุฎุฏู ููุงุฆู ููุทูุฉ ููููุฒุงุช ูุงูููุงุท ุงููููุฉ
              - ุฃุถู ููุงุญุธุงุช ูุชุญุฐูุฑุงุช ุนูุฏ ุงูุญุงุฌุฉ ุจุตูุบุฉ "ููุงุญุธุฉ:" ุฃู "ุชุญุฐูุฑ:"
              - ุชุฌูุจ ุงุณุชุฎุฏุงู ุนูุงูุงุช ุงููุฌูุฉ (**) ููุชูุณูู
              - ูุฏู ุฅุฌุงุจุงุช ูุจุงุดุฑุฉ ููุฎุชุตุฑุฉ ูุนูููุฉ
              - ุฑูุฒ ุนูู ุงูุญููู ุงูุนูููุฉ ูุงูุฎุทูุงุช ุงููุญุฏุฏุฉ
              - ุงุณุชุฎุฏู ูุบุฉ ูุงุถุญุฉ ูุจุณูุทุฉ
              `

              // ุงุณุชุฎุฏุงู Gemini ูุชูููุฏ ุงูุงุณุชุฌุงุจุฉ
              const response = await this.geminiService.generateContent(query, systemPrompt)

              // ุชูุธูู ุงููุต ูู ุนูุงูุงุช ุงููุฌูุฉ ูุชุญุณูู ุงูุชูุณูู
              const cleanedResponse = this.cleanResponseFormatting(response)

              // ุชุญููู ููุน ุงูุงุณุชุนูุงู
              const queryType = this.analyzeQueryType(query)

              // ุฅุฐุง ูุงู ุงูุงุณุชุนูุงู ูุชุนูู ุจุงูุชุตููู ุฃู ุงูุชุฎุทูุทุ ูู ุจุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ
              if ((queryType === "design" || queryType === "planning") && this.useMindMaps) {
                // ุชูููุฏ ุฎุฑูุทุฉ ุฐูููุฉ
                await this.mindMapGenerator.generateMindMap(query, cleanedResponse)
              }

              // ุชุฎุฒูู ุงูุงุณุชุฌุงุจุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
              this.cache.set(cacheKey, cleanedResponse)

              resolve(cleanedResponse)
              return
            } catch (error) {
              console.error("ุฎุทุฃ ูู ุงุณุชุฎุฏุงู Gemini:", error)
              // ูู ุญุงูุฉ ูุดู Geminiุ ุงุณุชุฎุฏู ุงูุทุฑููุฉ ุงูุงุญุชูุงุทูุฉ
            }
          }

          // ุชุญููู ููุน ุงูุงุณุชุนูุงู
          const queryType = this.analyzeQueryType(query)

          // ุชูููุฏ ุงุณุชุฌุงุจุฉ ุจูุงุกู ุนูู ููุน ุงูุงุณุชุนูุงู
          let response = ""
          switch (queryType) {
            case "programming":
              response = this.generateProgrammingResponse(query)
              break
            case "data_analysis":
              response = this.generateDataAnalysisResponse(query)
              break
            case "content_creation":
              response = this.generateContentResponse(query)
              break
            case "design":
              response = this.generateDesignResponse(query)

              // ุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ ุฅุฐุง ูุงู ููุนูุงู
              if (this.useMindMaps) {
                this.mindMapGenerator.generateMindMap(query, response)
              }
              break
            case "planning":
              response = this.generatePlanningResponse(query)

              // ุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ ุฅุฐุง ูุงู ููุนูุงู
              if (this.useMindMaps) {
                this.mindMapGenerator.generateMindMap(query, response)
              }
              break
            default:
              response = this.generateGeneralResponse(query)
          }

          // ุชุทุจูู ุดุฎุตูุฉ ุงูุจูุช ุนูู ุงูุงุณุชุฌุงุจุฉ
          const finalResponse = this.applyPersonality(response)

          // ุชุฎุฒูู ุงูุงุณุชุฌุงุจุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
          this.cache.set(cacheKey, finalResponse)

          resolve(finalResponse)
        } catch (error) {
          console.error("ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงูุงุณุชุนูุงู:", error)
          resolve("ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุงุณุชุนูุงู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.")
        } finally {
          // ุฅุฒุงูุฉ ุงููููุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
          this.processNextInQueue()
        }
      })

      // ุจุฏุก ูุนุงูุฌุฉ ุงูููุงู ุฅุฐุง ูู ุชูู ููุฏ ุงูุชูููุฐ ุจุงููุนู
      if (!this.isProcessing) {
        this.processNextInQueue()
      }
    })
  }

  /**
   * ูุนุงูุฌุฉ ุงููููุฉ ุงูุชุงููุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
   */
  private async processNextInQueue(): Promise<void> {
    if (this.processingQueue.length === 0) {
      this.isProcessing = false
      return
    }

    this.isProcessing = true

    // ุชุญุฏูุฏ ุนุฏุฏ ุงูููุงู ุงูุชู ุณูุชู ูุนุงูุฌุชูุง ุจุงูุชูุงุฒู
    const tasksToProcess = Math.min(this.maxConcurrentProcessing, this.processingQueue.length)
    const currentTasks = this.processingQueue.splice(0, tasksToProcess)

    // ูุนุงูุฌุฉ ุงูููุงู ุจุงูุชูุงุฒู
    await Promise.all(currentTasks.map((task) => task()))

    // ูุนุงูุฌุฉ ุงูููุงู ุงููุชุจููุฉ
    if (this.processingQueue.length > 0) {
      this.processNextInQueue()
    } else {
      this.isProcessing = false
    }
  }

  // ุฅุถุงูุฉ ุฏุงูุฉ ุฌุฏูุฏุฉ ูุชูุณูู ุงูุงุณุชุฌุงุจุฉ
  private cleanResponseFormatting(text: string): string {
    // ุฅุฒุงูุฉ ุนูุงูุงุช ุงููุฌูุฉ ุงููุฒุฏูุฌุฉ ูุชุญููููุง ุฅูู ุชูุณูู ููุงุณุจ
    let cleaned = text
      .replace(/\*\*(.*?)\*\*/g, "$1") // ุฅุฒุงูุฉ ุนูุงูุงุช ุงููุฌูุฉ ุงููุฒุฏูุฌุฉ
      .replace(/\n\s*\d+\.\s*/g, "\n\n$&") // ุฅุถุงูุฉ ูุณุงูุฉ ูุจู ุงูุนูุงุตุฑ ุงููุฑููุฉ
      .replace(/\n\s*โข\s*/g, "\n\n$&") // ุฅุถุงูุฉ ูุณุงูุฉ ูุจู ุงูููุงุท
      .replace(/\n\s*-\s*/g, "\n\n$&") // ุฅุถุงูุฉ ูุณุงูุฉ ูุจู ุงูููุงุท ุจุนูุงูุฉ ุงูุดุฑุทุฉ

    // ุชุญุณูู ุชูุณูู ุงูุนูุงููู
    cleaned = cleaned
      .replace(/^#\s+(.+)$/gm, "\n# $1\n")
      .replace(/^##\s+(.+)$/gm, "\n## $1\n")
      .replace(/^###\s+(.+)$/gm, "\n### $1\n")

    // ุชุญุณูู ุชูุณูู ุงูููุงุญุธุงุช ูุงูุชุญุฐูุฑุงุช
    cleaned = cleaned
      .replace(/ููุงุญุธุฉ:/g, "\nููุงุญุธุฉ: ")
      .replace(/ุชุญุฐูุฑ:/g, "\nุชุญุฐูุฑ: ")
      .replace(/ูุงู:/g, "\nูุงู: ")

    return cleaned
  }

  /**
   * ุงูุญุตูู ุนูู ุชูุฌูู ุงููุธุงู ุจูุงุกู ุนูู ุดุฎุตูุฉ ุงูุจูุช
   */
  private getSystemPromptForPersonality(): string {
    switch (this.personality) {
      case "technical":
        return "ุฃูุช ูุณุงุนุฏ ุฐูู ูุชุฎุตุต ูู ุงููุฌุงูุงุช ุงูุชูููุฉ. ุงุณุชุฎุฏู ูุตุทูุญุงุช ุชูููุฉ ุฏูููุฉ ููุฏู ุฅุฌุงุจุงุช ููุตูุฉ ููุฏุนููุฉ ุจุงูุฃุฏูุฉ."
      case "friendly":
        return "ุฃูุช ูุณุงุนุฏ ูุฏูุฏ ููุชุนุงุทู. ุงุณุชุฎุฏู ูุบุฉ ุฏุงูุฆุฉ ูุดุฎุตูุฉ ูุดุฌุน ุงููุณุชุฎุฏู."
      case "professional":
        return "ุฃูุช ูุณุงุนุฏ ุงุญุชุฑุงูู. ุงุณุชุฎุฏู ูุบุฉ ุฑุณููุฉ ูููุธูุฉ ููุฏู ุฅุฌุงุจุงุช ููุฌุฒุฉ ูุฏูููุฉ."
      case "creative":
        return "ุฃูุช ูุณุงุนุฏ ุฅุจุฏุงุนู. ุงุณุชุฎุฏู ูุบุฉ ุฎูุงููุฉ ูููููุฉ ููุฏู ุฃููุงุฑุงู ุบูุฑ ุชูููุฏูุฉ."
      case "sarcastic":
        return "ุฃูุช ูุณุงุนุฏ ุฐูู ูุน ููุณุฉ ูู ุงูููุงูุฉ ูุงูุณุฎุฑูุฉ. ูู ูุฑุญุงู ูููู ูููุฏุงู."
      default:
        return "ุฃูุช ูุณุงุนุฏ ุฐูู. ูุฏู ุฅุฌุงุจุงุช ุฏูููุฉ ููููุฏุฉ ุจุฃุณููุจ ูุชูุงุฒู."
    }
  }

  /**
   * ุชูููุฐ ุงูุชูููุฑ ุงูุนููู
   */
  async performDeepThinking(query: string): Promise<string[]> {
    // ุงูุชุญูู ูู ูุฌูุฏ ุงูุงุณุชุนูุงู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
    const cacheKey = `thinking_${query}`
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey)
    }

    if (this.useGemini && this.useDeepThinking) {
      try {
        const steps = await this.geminiService.deepThinking(query)
        this.cache.set(cacheKey, steps)
        return steps
      } catch (error) {
        console.error("ุฎุทุฃ ูู ุงูุชูููุฑ ุงูุนููู ุจุงุณุชุฎุฏุงู Gemini:", error)
      }
    }

    // ุทุฑููุฉ ุงุญุชูุงุทูุฉ ููุชูููุฑ ุงูุนููู
    const defaultSteps = [
      "ุชุญููู ุงูุณุคุงู ูููู ุงููุชุทูุจุงุช...",
      "ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุนุฑูุฉ ุนู ูุนูููุงุช ุฐุงุช ุตูุฉ...",
      "ุชุญุฏูุฏ ุงูููุงููู ุงูุฑุฆูุณูุฉ ูุงูุนูุงูุงุช ุจูููุง...",
      "ุชุทุจูู ุงูููุทู ุงูุงุณุชูุชุงุฌู ูููุตูู ุฅูู ุฅุฌุงุจุฉ...",
      "ุตูุงุบุฉ ุงูุฅุฌุงุจุฉ ุจุทุฑููุฉ ูุงุถุญุฉ ููููููุฉ...",
    ]

    this.cache.set(cacheKey, defaultSteps)
    return defaultSteps
  }

  /**
   * ุชูููุฐ ุงูุจุญุซ ุนูู ุงูููุจ
   */
  async performWebSearch(query: string): Promise<WebSearchResult[]> {
    // ุงูุชุญูู ูู ูุฌูุฏ ุงูุงุณุชุนูุงู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
    const cacheKey = `search_${query}`
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey)
    }

    if (this.useGemini && this.useWebResearch) {
      try {
        const results = await this.geminiService.webSearch(query)
        this.cache.set(cacheKey, results)
        return results
      } catch (error) {
        console.error("ุฎุทุฃ ูู ุงูุจุญุซ ุนูู ุงูููุจ ุจุงุณุชุฎุฏุงู Gemini:", error)
      }
    }

    // ุทุฑููุฉ ุงุญุชูุงุทูุฉ ููุจุญุซ ุนูู ุงูููุจ
    const defaultResults = [
      {
        id: "1",
        title: "ูุชุงุฆุฌ ุงูุจุญุซ ุงูุฃููู ุญูู " + query,
        url: "https://example.com/result1",
        snippet: "ููุชุทู ูู ูุชุงุฆุฌ ุงูุจุญุซ ูุญุชูู ุนูู ูุนูููุงุช ุฐุงุช ุตูุฉ ุจุงูุงุณุชุนูุงู...",
      },
      {
        id: "2",
        title: "ูุนูููุงุช ุฅุถุงููุฉ ุนู " + query,
        url: "https://example.com/result2",
        snippet: "ูุฒูุฏ ูู ุงููุนูููุงุช ุงูุชูุตูููุฉ ุญูู ุงูููุถูุน ุงููุทููุจ...",
      },
      {
        id: "3",
        title: "ุฃุญุฏุซ ุงูุจูุงูุงุช ุงููุชุนููุฉ ุจู " + query,
        url: "https://example.com/result3",
        snippet: "ุจูุงูุงุช ูุญุฏุซุฉ ููุนูููุงุช ุฌุฏูุฏุฉ ุชู ูุดุฑูุง ูุคุฎุฑุงู...",
      },
    ]

    this.cache.set(cacheKey, defaultResults)
    return defaultResults
  }

  /**
   * ุชูููุฏ ููุฏ ุจุฑูุฌู
   */
  async generateCodeForQuery(query: string, language = "javascript"): Promise<CodeGenerationResult> {
    // ุงูุชุญูู ูู ูุฌูุฏ ุงูุงุณุชุนูุงู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
    const cacheKey = `code_${query}_${language}`
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey)
    }

    if (this.useGemini) {
      try {
        const result = await this.geminiService.generateCode(query, language)
        this.cache.set(cacheKey, result)
        return result
      } catch (error) {
        console.error("ุฎุทุฃ ูู ุชูููุฏ ุงูููุฏ ุจุงุณุชุฎุฏุงู Gemini:", error)
      }
    }

    // ุทุฑููุฉ ุงุญุชูุงุทูุฉ ูุชูููุฏ ุงูููุฏ
    const defaultResult = {
      code: this.generateSampleCode(query),
      language,
      prompt: query,
    }

    this.cache.set(cacheKey, defaultResult)
    return defaultResult
  }

  /**
   * ุชุญููู ููุน ุงูุงุณุชุนูุงู
   */
  private analyzeQueryType(query: string): string {
    const lowerQuery = query.toLowerCase()

    if (
      lowerQuery.includes("ููุฏ") ||
      lowerQuery.includes("ุจุฑูุฌ") ||
      lowerQuery.includes("ุชุทููุฑ") ||
      lowerQuery.includes("javascript") ||
      lowerQuery.includes("python") ||
      lowerQuery.includes("react")
    ) {
      return "programming"
    }

    if (
      lowerQuery.includes("ุจูุงูุงุช") ||
      lowerQuery.includes("ุชุญููู") ||
      lowerQuery.includes("ุฅุญุตุงุก") ||
      lowerQuery.includes("ุฑุณู ุจูุงูู") ||
      lowerQuery.includes("ุฌุฏูู")
    ) {
      return "data_analysis"
    }

    if (
      lowerQuery.includes("ุงูุชุจ") ||
      lowerQuery.includes("ููุงู") ||
      lowerQuery.includes("ูุญุชูู") ||
      lowerQuery.includes("ูุต") ||
      lowerQuery.includes("ุชูุฑูุฑ")
    ) {
      return "content_creation"
    }

    if (
      lowerQuery.includes("ุชุตููู") ||
      lowerQuery.includes("ูุงุฌูุฉ") ||
      lowerQuery.includes("ui") ||
      lowerQuery.includes("ux") ||
      lowerQuery.includes("ุตูุฑุฉ") ||
      lowerQuery.includes("ุตูุญุฉ ูุจูุท") ||
      lowerQuery.includes("landing page")
    ) {
      return "design"
    }

    if (
      lowerQuery.includes("ุฎุทุฉ") ||
      lowerQuery.includes("ุงุณุชุฑุงุชูุฌูุฉ") ||
      lowerQuery.includes("ุฎุฑูุทุฉ") ||
      lowerQuery.includes("ุชุฎุทูุท") ||
      lowerQuery.includes("ุฎุทูุงุช")
    ) {
      return "planning"
    }

    return "general"
  }

  /**
   * ุชูููุฏ ุงุณุชุฌุงุจุฉ ูุงุณุชุนูุงูุงุช ุงูุจุฑูุฌุฉ
   */
  private generateProgrammingResponse(query: string): string {
    // ููุง ูููู ุฅุถุงูุฉ ููุทู ุฃูุซุฑ ุชุนููุฏุงู ูุชูููุฏ ุงุณุชุฌุงุจุงุช ุจุฑูุฌูุฉ
    return `
    # ุงูุญู ุงูุจุฑูุฌู
    
    ุจูุงุกู ุนูู ุทูุจูุ ุฅููู ุงูุญู ุงูุจุฑูุฌู ุงูููุงุณุจ:
    
    ## ูุธุฑุฉ ุนุงูุฉ
    
    ููุฏ ููุช ุจุฅูุดุงุก ููุฏ ููุจู ูุชุทูุจุงุชู. ููููู ุงูุงุทูุงุน ุนูู ุงูููุฏ ูู ุนูุงูุฉ ุงูุชุจููุจ "ุงูููุฏ" ุฃู ูุชุญู ูุจุงุดุฑุฉ ูู Visual Studio ููุชุนุฏูู ุนููู.
    
    ## ุงูููููุงุช ุงูุฑุฆูุณูุฉ
    
    1. ูููู ุฃุณุงุณู ููุชุทุจูู ุงููุทููุจ
    2. ูุธุงุฆู ุงูุชุนุงูู ูุน ุงูุจูุงูุงุช
    3. ูุงุฌูุฉ ูุณุชุฎุฏู ุจุณูุทุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู
    
    ## ุดุฑุญ ุงูููุฏ
    
    - ุชู ุงุณุชุฎุฏุงู ููุท ุงูุชุตููู MVC ููุตู ุงูููุทู ุนู ุงูุนุฑุถ
    - ุชู ุชูููุฐ ุงูุชุญูู ูู ุงููุฏุฎูุงุช ูุถูุงู ุณูุงูุฉ ุงูุจูุงูุงุช
    - ุชู ุฅุถุงูุฉ ุชุนูููุงุช ุชูุถูุญูุฉ ููู ูุธููุฉ ุฑุฆูุณูุฉ
    
    ููุงุญุธุฉ: ููููู ุชุฎุตูุต ุงูููุฏ ุญุณุจ ุงุญุชูุงุฌุงุชู ุงูุฎุงุตุฉ.
    
    ูู ุชุฑุบุจ ูู ุฅุฌุฑุงุก ุฃู ุชุนุฏููุงุช ุนูู ุงูููุฏ ุฃู ุชูุถูุญ ุฃู ุฌุฒุก ูููุ
    `
  }

  /**
   * ุชูููุฏ ุงุณุชุฌุงุจุฉ ูุงุณุชุนูุงูุงุช ุชุญููู ุงูุจูุงูุงุช
   */
  private generateDataAnalysisResponse(query: string): string {
    return `
    # ุชุญููู ุงูุจูุงูุงุช
    
    ุจุนุฏ ุชุญููู ุงูุจูุงูุงุช ุงูููุฏูุฉุ ุชูุตูุช ุฅูู ุงููุชุงุฆุฌ ุงูุชุงููุฉ:
    
    ## ุงูุงุชุฌุงูุงุช ุงูุฑุฆูุณูุฉ
    
    1. ุฒูุงุฏุฉ ุจูุณุจุฉ 23% ูู ูุนุฏูุงุช ุงูููู ุฎูุงู ุงูุฑุจุน ุงูุฃุฎูุฑ
    2. ุงูุฎูุงุถ ุชูุงููู ุงูุชุดุบูู ุจูุณุจุฉ 12% ููุงุฑูุฉ ุจุงูุนุงู ุงูุณุงุจู
    3. ุชุญุณู ูู ูุคุดุฑุงุช ุงูุฃุฏุงุก ุงูุฑุฆูุณูุฉ ุจูุนุฏู 8.5%
    
    ## ุงูุชูุตูุงุช
    
    - ุงูุชุฑููุฒ ุนูู ุชุทููุฑ ุงููุทุงุน A ูุธุฑุงู ููุนุฏูุงุช ุงูููู ุงูุนุงููุฉ
    - ุฅุนุงุฏุฉ ููููุฉ ุงูุนูููุงุช ูู ุงููุทุงุน B ูุชุญุณูู ุงูููุงุกุฉ
    - ุฒูุงุฏุฉ ุงูุงุณุชุซูุงุฑ ูู ูุฌุงูุงุช ุงูุงุจุชูุงุฑ ูุชุนุฒูุฒ ุงูููุฒุฉ ุงูุชูุงูุณูุฉ
    
    ## ุงูุฎุทูุงุช ุงูุชุงููุฉ
    
    1. ุฅุนุฏุงุฏ ุชูุฑูุฑ ุชูุตููู ููู ูุทุงุน
    2. ุชุญุฏูุฏ ูุคุดุฑุงุช ุงูุฃุฏุงุก ุงูุฑุฆูุณูุฉ ููุฑุจุน ุงููุงุฏู
    3. ูุฑุงุฌุนุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ ุจูุงุกู ุนูู ุงููุชุงุฆุฌ ุงูุญุงููุฉ
    
    ูู ุชุฑุบุจ ูู ุชุญููู ุฃุนูู ูุฃู ูู ูุฐู ุงูููุงุทุ
    `
  }

  /**
   * ุชูููุฏ ุงุณุชุฌุงุจุฉ ูุงุณุชุนูุงูุงุช ุฅูุดุงุก ุงููุญุชูู
   */
  private generateContentResponse(query: string): string {
    return `
    # ุชุฃุซูุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุนูู ูุณุชูุจู ุงูุนูู
    
    ูู ุนุตุฑ ุงูุชุญูู ุงูุฑููู ุงูุณุฑูุนุ ูุจุฑุฒ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูููุฉ ูุญูุฑูุฉ ุชุนูุฏ ุชุดููู ูุดูุฏ ุงูุนูู ุงูุนุงููู. ูุฐุง ุงูููุงู ูุณุชูุดู ุงูุชุฃุซูุฑุงุช ุงููุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ ููุฐูุงุก ุงูุงุตุทูุงุนู ุนูู ูุณุชูุจู ุงูุนููุ ูุชูุงููุงู ุงููุฑุต ูุงูุชุญุฏูุงุช ุงูุชู ุชูุชุธุฑูุง.
    
    ## ุงูุชุญููุงุช ุงููุธูููุฉ
    
    ูุคุฏู ุงูุชุดุงุฑ ุชูููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุฅูู ุชุญููุงุช ุฌุฐุฑูุฉ ูู ุณูู ุงูุนูู. ุจูููุง ุชุฎุชูู ุจุนุถ ุงููุธุงุฆู ุงูุชูููุฏูุฉุ ุชุธูุฑ ูุฑุต ุฌุฏูุฏุฉ ุชุชุทูุจ ููุงุฑุงุช ูุฎุชููุฉ. ุงููุธุงุฆู ุงูุฑูุชูููุฉ ูุงููุงุจูุฉ ููุฃุชูุชุฉ ูู ุงูุฃูุซุฑ ุนุฑุถุฉ ููุงุณุชุจุฏุงูุ ูู ุญูู ุชุฒุฏุงุฏ ุฃูููุฉ ุงูููุงุฑุงุช ุงูุฅุจุฏุงุนูุฉ ูุงูุชุญููููุฉ ูุงูุงุฌุชูุงุนูุฉ.
    
    ## ุฅุนุงุฏุฉ ุชุนุฑูู ุงูุฅูุชุงุฌูุฉ
    
    ูููู ููุฐูุงุก ุงูุงุตุทูุงุนู ุชุนุฒูุฒ ุงูุฅูุชุงุฌูุฉ ุจุดูู ูุจูุฑ ูู ุฎูุงู:
    
    - ุฃุชูุชุฉ ุงูููุงู ุงูุฑูุชูููุฉ
    - ุชุณุฑูุน ุนูููุงุช ุงุชุฎุงุฐ ุงููุฑุงุฑ
    - ุชุญุณูู ุฏูุฉ ุงูุชูุจุคุงุช ูุงูุชุญูููุงุช
    
    ูุฐุง ูุชูุญ ููุนุงูููู ุงูุชุฑููุฒ ุนูู ุงูุฌูุงูุจ ุงูุฃูุซุฑ ูููุฉ ูุฅุจุฏุงุนุงู ูู ุนููููุ ููุง ูุคุฏู ุฅูู ุชุญุณูู ุฌูุฏุฉ ุงููุฎุฑุฌุงุช ูุฒูุงุฏุฉ ุงูุฑุถุง ุงููุธููู.
    
    ## ุงูุชุญุฏูุงุช ูุงููุฑุต
    
    ุฑุบู ุงูููุงุฆุฏ ุงููุญุชููุฉุ ููุงุฌู ุงููุฌุชูุน ุชุญุฏูุงุช ูุจูุฑุฉ ูู ุงูุชููู ูุน ูุฐู ุงูุชุบููุฑุงุช. ูุชุทูุจ ุงูุฃูุฑ ุงุณุชุซูุงุฑุงุช ุถุฎูุฉ ูู ุฅุนุงุฏุฉ ุชุฃููู ุงูููู ุงูุนุงููุฉ ูุชุทููุฑ ุฃูุธูุฉ ุชุนููููุฉ ุชุฑูุฒ ุนูู ุงูููุงุฑุงุช ุงููุณุชูุจููุฉ. ููุง ุชุจุฑุฒ ุฃุณุฆูุฉ ุฃุฎูุงููุฉ ุญูู ุงูุนุฏุงูุฉ ูู ุชูุฒูุน ููุงุฆุฏ ูุฐู ุงูุชูููุงุช.
    
    ุชุญุฐูุฑ: ูุฌุจ ุนูู ุงููุคุณุณุงุช ูุงูุญูููุงุช ุงูุชุญุฑู ุณุฑูุนุงู ูููุงุฌูุฉ ูุฐู ุงูุชุญุฏูุงุช ูุจู ุฃู ุชุชุณุน ุงููุฌูุฉ ุจูู ุงูููุงุฑุงุช ุงููุทููุจุฉ ูุงููุชููุฑุฉ.
    
    ูู ุชุฑุบุจ ูู ุชูุณูุน ุฃู ุฌุฒุก ูู ูุฐุง ุงููุญุชูู ุฃู ุชุนุฏููู ูููุงุณุจ ุงุญุชูุงุฌุงุชู ุจุดูู ุฃูุถูุ
    `
  }

  /**
   * ุชูููุฏ ุงุณุชุฌุงุจุฉ ูุงุณุชุนูุงูุงุช ุงูุชุตููู
   */
  private generateDesignResponse(query: string): string {
    return `
    # ุชุตููู ูุงุฌูุฉ ุชุทุจูู ุชุชุจุน ุงูููุงูุฉ ุงูุจุฏููุฉ
    
    ุจูุงุกู ุนูู ุทูุจูุ ุฅููู ุงูุชุฑุงุญ ุชุตููู ููุงุฌูุฉ ุชุทุจูู ุชุชุจุน ุงูููุงูุฉ ุงูุจุฏููุฉ:
    
    ## ุงูุนูุงุตุฑ ุงูุฑุฆูุณูุฉ ูููุงุฌูุฉ
    
    ### 1. ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
    
    - ููุญุฉ ูุนูููุงุช ุชุนุฑุถ ููุฎุต ุงููุดุงุท ุงููููู (ุงูุฎุทูุงุชุ ุงูุณุนุฑุงุช ุงูุญุฑุงุฑูุฉุ ุงูููุช ุงููุดุท)
    - ูุฎุทุท ุฏุงุฆุฑู ููุถุญ ุงูุชูุฏู ูุญู ุงูุฃูุฏุงู ุงูููููุฉ
    - ุฃุฒุฑุงุฑ ุณุฑูุนุฉ ูุจุฏุก ุชูุงุฑูู ูุฎุชููุฉ
    
    ### 2. ุดุงุดุฉ ุงูุชูุงุฑูู
    
    - ูุงุฆูุฉ ุจุงูุชูุงุฑูู ุงููุฎุตุตุฉ ูุน ุตูุฑ ุชูุถูุญูุฉ
    - ุฎูุงุฑุงุช ูุชุชุจุน ุงูููุช ูุงูุชูุฑุงุฑุงุช ูุงูุฃูุฒุงู
    - ุนุฑุถ ููุณุฌู ุงูุชุงุฑูุฎู ูุน ุฑุณูู ุจูุงููุฉ ููุชูุฏู
    
    ### 3. ุดุงุดุฉ ุงูุชุบุฐูุฉ
    
    - ุชุชุจุน ุงูุณุนุฑุงุช ุงูุญุฑุงุฑูุฉ ูุงูุนูุงุตุฑ ุงูุบุฐุงุฆูุฉ
    - ูุงุนุฏุฉ ุจูุงูุงุช ููุฃุทุนูุฉ ุงูุดุงุฆุนุฉ ูุน ุฅููุงููุฉ ุฅุถุงูุฉ ุนูุงุตุฑ ูุฎุตุตุฉ
    - ุชุญููู ูููุท ุงูุงุณุชููุงู ุงูุบุฐุงุฆู
    
    ## ูุธุงู ุงูุฃููุงู ุงูููุชุฑุญ
    
    - ุงูููู ุงูุฑุฆูุณู: ุฃุฒุฑู ูุงุชุญ (#4A90E2) - ูุฑูุฒ ูููุดุงุท ูุงูุญูููุฉ
    - ุงูููู ุงูุซุงููู: ุฃุฎุถุฑ ูุงุชุญ (#50E3C2) - ูุฑูุฒ ููุตุญุฉ ูุงูุชูุงุฒู
    - ุฎูููุฉ: ุฑูุงุฏู ูุงุชุญ ุฌุฏุงู (#F8F8F8) - ูุชุญุณูู ุงููุฑุงุกุฉ ูุชูููู ุฅุฌูุงุฏ ุงูุนูู
    
    ## ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู
    
    1. ุชุตููู ุจุณูุท ูุณูู ุงูุงุณุชุฎุฏุงู
    2. ุชููู ุณูุณ ุจูู ุงูุดุงุดุงุช ุงููุฎุชููุฉ
    3. ุชุบุฐูุฉ ุฑุงุฌุนุฉ ููุฑูุฉ ูููุณุชุฎุฏู
    4. ุฏุนู ุงููุถุน ุงููุธูู ูุงููุถุน ุงููุงุชุญ
    
    ููุงุญุธุฉ: ูููู ุชุฎุตูุต ูุฐุง ุงูุชุตููู ุจุณูููุฉ ูููุงุณุจ ูููุฉ ุนูุงูุชู ุงูุชุฌุงุฑูุฉ.
    
    ูู ุชุฑุบุจ ูู ุงูุญุตูู ุนูู ุชูุงุตูู ุฃูุซุฑ ุนู ุฃู ุฌุฒุก ูู ุงูุชุตูููุ
    `
  }

  /**
   * ุชูููุฏ ุงุณุชุฌุงุจุฉ ูุงุณุชุนูุงูุงุช ุงูุชุฎุทูุท
   */
  private generatePlanningResponse(query: string): string {
    return `
    # ุฎุทุฉ ุฅุทูุงู ููุชุฌ ุฌุฏูุฏ
    
    ุจูุงุกู ุนูู ุทูุจูุ ุฅููู ุฎุทุฉ ุดุงููุฉ ูุฅุทูุงู ููุชุฌู ุงูุฌุฏูุฏ:
    
    ## ุงููุฑุงุญู ุงูุฑุฆูุณูุฉ
    
    ### 1. ูุฑุญูุฉ ุงูุชุญุถูุฑ (4-6 ุฃุณุงุจูุน)
    
    - ุชุญุฏูุฏ ุงูุฌูููุฑ ุงููุณุชูุฏู ูุงููููุฉ ุงูููุฏูุฉ
    - ุฅุฌุฑุงุก ุฃุจุญุงุซ ุงูุณูู ูุงูููุงูุณูู
    - ุชุทููุฑ ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุณุนูุฑ ูุงูุชูุฒูุน
    - ุฅุนุฏุงุฏ ุฎุทุฉ ุงูุชุณููู ูุงูุงุชุตุงูุงุช
    
    ### 2. ูุฑุญูุฉ ุงูุงุฎุชุจุงุฑ (2-3 ุฃุณุงุจูุน)
    
    - ุฅุทูุงู ูุณุฎุฉ ุชุฌุฑูุจูุฉ ูุญุฏูุฏุฉ (ุจูุชุง)
    - ุฌูุน ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ ูู ุงููุณุชุฎุฏููู ุงูุฃูุงุฆู
    - ุฅุฌุฑุงุก ุงูุชุนุฏููุงุช ุงููุงุฒูุฉ ุจูุงุกู ุนูู ุงูููุงุญุธุงุช
    - ุงุฎุชุจุงุฑ ูููุงุช ุงูุชูุฒูุน ูุงูุฏุนู
    
    ### 3. ูุฑุญูุฉ ุงูุฅุทูุงู (1-2 ุฃุณุงุจูุน)
    
    - ุฅุทูุงู ุญููุฉ ุชุณููููุฉ ูุชูุงููุฉ
    - ุชูุนูู ุฌููุน ูููุงุช ุงูุชูุฒูุน
    - ุชูุธูู ูุนุงููุฉ ุฅุทูุงู (ุงูุชุฑุงุถูุฉ ุฃู ูุงูุนูุฉ)
    - ุจุฏุก ุจุฑูุงูุฌ ุงูููุงุก ูููุณุชุฎุฏููู ุงูุฃูุงุฆู
    
    ### 4. ูุฑุญูุฉ ูุง ุจุนุฏ ุงูุฅุทูุงู (ูุณุชูุฑุฉ)
    
    - ูุฑุงูุจุฉ ุฃุฏุงุก ุงูููุชุฌ ูุงููุจูุนุงุช
    - ุฌูุน ูุชุญููู ุจูุงูุงุช ุงููุณุชุฎุฏููู
    - ุฅุทูุงู ุชุญุฏูุซุงุช ูุชุญุณููุงุช ุฏูุฑูุฉ
    - ุชูุณูุน ูุงุนุฏุฉ ุงููุณุชุฎุฏููู ููุชุญ ุฃุณูุงู ุฌุฏูุฏุฉ
    
    ## ุงูููุฒุงููุฉ ุงูุชูุฏูุฑูุฉ
    
    - ุชุทููุฑ ุงูููุชุฌ: 40% ูู ุงูููุฒุงููุฉ ุงูุฅุฌูุงููุฉ
    - ุงูุชุณููู ูุงูุฅุนูุงู: 30% ูู ุงูููุฒุงููุฉ ุงูุฅุฌูุงููุฉ
    - ุงูุนูููุงุช ูุงูููุฌุณุชูุงุช: 20% ูู ุงูููุฒุงููุฉ ุงูุฅุฌูุงููุฉ
    - ุงุญุชูุงุทู ููุทูุงุฑุฆ: 10% ูู ุงูููุฒุงููุฉ ุงูุฅุฌูุงููุฉ
    
    ## ูุคุดุฑุงุช ุงููุฌุงุญ ุงูุฑุฆูุณูุฉ
    
    1. ุนุฏุฏ ุงููุณุชุฎุฏููู/ุงูุนููุงุก ุงูููุชุณุจูู
    2. ูุนุฏู ุงูุงุญุชูุงุธ ุจุงูุนููุงุก
    3. ูุชูุณุท ูููุฉ ุงูุทูุจ/ุงููุดุชุฑู
    4. ูุนุฏู ุชุญููู ุงููุจูุนุงุช
    5. ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ ุงูุชุณูููู
    
    ุชุญุฐูุฑ: ูู ูุณุชุนุฏุงู ููุชููู ูุน ุธุฑูู ุงูุณูู ุงููุชุบูุฑุฉ ูุชุนุฏูู ุงูุฎุทุฉ ุญุณุจ ุงูุญุงุฌุฉ.
    
    ูู ุชุฑุบุจ ูู ุชูุงุตูู ุฃูุซุฑ ุนู ุฃู ูุฑุญูุฉ ูู ูุฑุงุญู ุงูุฎุทุฉุ
    `
  }

  /**
   * ุชูููุฏ ุงุณุชุฌุงุจุฉ ุนุงูุฉ
   */
  private generateGeneralResponse(query: string): string {
    return `
    # ุงูุฅุฌุงุจุฉ ุนูู ุงุณุชูุณุงุฑู
    
    ุดูุฑุงู ุนูู ุณุคุงูู. ุจูุงุกู ุนูู ุงุณุชูุณุงุฑูุ ูููููู ุชูุฏูู ุงููุนูููุงุช ุงูุชุงููุฉ:
    
    ## ุงูููุงุท ุงูุฑุฆูุณูุฉ
    
    ุงูููุถูุน ุงูุฐู ุณุฃูุช ุนูู ูุชุถูู ุนุฏุฉ ุฌูุงูุจ ูููุฉ ูุฌุจ ูุฑุงุนุงุชูุง:
    
    1. ููู ุงูุณูุงู ุงูุนุงู ูุงูุนูุงูู ุงููุคุซุฑุฉ
    2. ุชุญุฏูุฏ ุงูููุงุฑุจุงุช ุงููุฎุชููุฉ ูุชูููู ูุฒุงูุงูุง ูุชุญุฏูุงุชูุง
    3. ุงุฎุชูุงุฑ ุงูุญู ุงูุฃูุณุจ ุจูุงุกู ุนูู ุงุญุชูุงุฌุงุชู ุงูุฎุงุตุฉ
    
    ## ุงูุฎุทูุงุช ุงูููุชุฑุญุฉ
    
    ููุชุนุงูู ูุน ูุฐุง ุงูููุถูุน ุจูุนุงููุฉุ ุฃูุตุญ ุจุงุชุจุงุน ุงูุฎุทูุงุช ุงูุชุงููุฉ:
    
    1. ุชุญุฏูุฏ ุฃูุฏุงูู ุจูุถูุญ
    2. ุฌูุน ุงููุนูููุงุช ุงููุงุฒูุฉ ูู ูุตุงุฏุฑ ููุซููุฉ
    3. ุชุญููู ุงูุฎูุงุฑุงุช ุงููุชุงุญุฉ ูุชูููู ูู ูููุง
    4. ูุถุน ุฎุทุฉ ุนูู ุชูุตูููุฉ ููุชูููุฐ
    5. ูุฑุงูุจุฉ ุงููุชุงุฆุฌ ูุฅุฌุฑุงุก ุงูุชุนุฏููุงุช ุงููุงุฒูุฉ
    
    ููุงุญุธุฉ: ูุฐู ุงูุฅุฑุดุงุฏุงุช ุนุงูุฉ ููููู ุชุฎุตูุตูุง ุญุณุจ ุญุงูุชู ุงูุฎุงุตุฉ.
    
    ูู ููุงู ุฌุงูุจ ูุนูู ุชุฑุบุจ ูู ุงูุชุนูู ููู ุฃูุซุฑุ
    `
  }

  /**
   * ุชูููุฏ ููุฏ ุนููุฉ
   */
  private generateSampleCode(query: string): string {
    if (query.includes("React") || query.includes("ูุงุฆูุฉ ููุงู")) {
      return `// ุชุทุจูู ูุงุฆูุฉ ููุงู ุจุณูุท ุจูุบุฉ React
import React, { useState } from 'react';

function TodoApp() {
  const [tasks, setTasks] = useState([]);
  const [inputValue, setInputValue] = useState('');

  const handleAddTask = () => {
    if (inputValue.trim() !== '') {
      setTasks([...tasks, { id: Date.now(), text: inputValue, completed: false }]);
      setInputValue('');
    }
  };

  const handleToggleComplete = (taskId) => {
    setTasks(tasks.map(task => 
      task.id === taskId ? { ...task, completed: !task.completed } : task
    ));
  };

  const handleDeleteTask = (taskId) => {
    setTasks(tasks.filter(task => task.id !== taskId));
  };

  return (
    <div className="todo-app">
      <h1>ูุงุฆูุฉ ุงูููุงู</h1>
      <div className="add-task">
        <input
          type="text"
          value={inputValue}
          onChange={(e) => setInputValue(e.target.value)}
          placeholder="ุฃุถู ูููุฉ ุฌุฏูุฏุฉ..."
        />
        <button onClick={handleAddTask}>ุฅุถุงูุฉ</button>
      </div>
      <ul className="task-list">
        {tasks.map(task => (
          <li key={task.id} className={task.completed ? 'completed' : ''}>
            <span onClick={() => handleToggleComplete(task.id)}>{task.text}</span>
            <button onClick={() => handleDeleteTask(task.id)}>ุญุฐู</button>
          </li>
        ))}
      </ul>
    </div>
  );
}

export default TodoApp;`
    } else {
      return `// ูุซุงู ุนูู ููุฏ JavaScript
function processData(data) {
  // ุชุญููู ุงูุจูุงูุงุช
  const processedData = data.map(item => {
    return { ...item, processed: true };
  });
  
  // ุชุทุจูู ุงูููุทู ุงูุฃุณุงุณู
  const result = processedData.filter(item => item.value > 0);
  
  return result;
}

// ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู
const data = [{ value: 5 }, { value: -2 }, { value: 10 }];
const result = processData(data);
console.log(result);`
    }
  }

  /**
   * ุชุทุจูู ุดุฎุตูุฉ ุงูุจูุช ุนูู ุงูุงุณุชุฌุงุจุฉ
   */
  private applyPersonality(response: string): string {
    switch (this.personality) {
      case "technical":
        return this.makeResponseTechnical(response)
      case "friendly":
        return this.makeResponseFriendly(response)
      case "professional":
        return this.makeResponseProfessional(response)
      case "creative":
        return this.makeResponseCreative(response)
      case "sarcastic":
        return this.makeResponseSarcastic(response)
      default:
        return response // neutral
    }
  }

  /**
   * ุชุญููู ุงูุงุณุชุฌุงุจุฉ ุฅูู ููุท ุชููู
   */
  private makeResponseTechnical(response: string): string {
    // ุฅุถุงูุฉ ูุตุทูุญุงุช ุชูููุฉ ููุฑุงุฌุน
    return (
      response
        .replace(/ูููู/g, "ูู ุงููุงุญูุฉ ุงูุชูููุฉุ ูููู")
        .replace(/ููู/g, "ุญุงุณู ูู ุงููุงุญูุฉ ุงูุชูููุฉ")
        .replace(/ุฌูุฏ/g, "ูุนุงู ุจูุณุจุฉ ุนุงููุฉ") +
      "\n\n## ููุงุญุธุงุช ุชูููุฉ ุฅุถุงููุฉ\n\nุชุฃูุฏ ูู ูุฑุงุนุงุฉ ูุชุทูุจุงุช ุงูุฃุฏุงุก ูุงูุชูุงูููุฉ ุนูุฏ ุชูููุฐ ูุฐุง ุงูุญู. ุงุณุชุฎุฏู ุฃุฏูุงุช ููุงุณ ุงูุฃุฏุงุก ูุชุญุณูู ุงูููุงุกุฉ."
    )
  }

  /**
   * ุชุญููู ุงูุงุณุชุฌุงุจุฉ ุฅูู ููุท ูุฏูุฏ
   */
  private makeResponseFriendly(response: string): string {
    // ุฅุถุงูุฉ ุนุจุงุฑุงุช ูุฏูุฉ ูุชุดุฌูุนูุฉ
    return (
      "# ูุฑุญุจุงู ุตุฏููู! ๐\n\n" +
      response.replace(/ูููู/g, "ููููู ุจูู ุณูููุฉ").replace(/ููู/g, "ุฑุงุฆุน ูููู") +
      "\n\n## ูููุฉ ุชุดุฌูุนูุฉ\n\nุฃุชููู ุฃู ูููู ูุฐุง ูููุฏุงู! ุฃูุช ุชููู ุจุนูู ุฑุงุฆุนุ ุงุณุชูุฑ ูู ุงูุชูุฏู! ูุง ุชุชุฑุฏุฏ ูู ุทูุจ ุงููุฒูุฏ ูู ุงููุณุงุนุฏุฉ ุฅุฐุง ุงุญุชุฌุช ูุฐูู. ๐"
    )
  }

  /**
   * ุชุญููู ุงูุงุณุชุฌุงุจุฉ ุฅูู ููุท ุงุญุชุฑุงูู
   */
  private makeResponseProfessional(response: string): string {
    // ุฅุถุงูุฉ ูุบุฉ ุฑุณููุฉ ูููุธูุฉ
    return (
      "# ุชูุฑูุฑ ุงุญุชุฑุงูู\n\nูููุงู ูููุนุงููุฑ ุงูููููุฉ ุงููุนุชูุฏุฉ:\n\n" +
      response.replace(/ูููู/g, "ูููุตู ุจู").replace(/ุฌูุฏ/g, "ููุงุฆู ูููุนุงููุฑ ุงูููููุฉ") +
      "\n\n## ุงูุฎูุงุตุฉ\n\nูุฃูู ุฃู ุชูุจู ูุฐู ุงููุนูููุงุช ุงุญุชูุงุฌุงุชูู ุงูููููุฉ. ูุฑุญุจ ุจุฃู ุงุณุชูุณุงุฑุงุช ุฅุถุงููุฉ."
    )
  }

  /**
   * ุชุญููู ุงูุงุณุชุฌุงุจุฉ ุฅูู ููุท ุฅุจุฏุงุนู
   */
  private makeResponseCreative(response: string): string {
    // ุฅุถุงูุฉ ูุบุฉ ุฎูุงููุฉ ูุฅุจุฏุงุนูุฉ
    return (
      "# โจ ุฑุญูุฉ ุฅุจุฏุงุนูุฉ โจ\n\n" +
      response.replace(/ูููู/g, "ุชุฎูู ุฃูู ุชุณุชุทูุน").replace(/ููุฑุฉ/g, "ุดุฑุงุฑุฉ ุฅุจุฏุงุนูุฉ") +
      "\n\n## ๐ ุขูุงู ุฌุฏูุฏุฉ\n\nูุฐู ูุฌุฑุฏ ุจุฏุงูุฉ ูุฑุญูุฉ ูู ุงูุงูุชุดุงู ูุงูุฅุจุฏุงุน! ูุง ุงูุฐู ููููู ูู ูุฐู ุงูุฃููุงุฑุ ุฏุน ุฎูุงูู ูุญูู ุจุนูุฏุงู!"
    )
  }

  /**
   * ุชุญููู ุงูุงุณุชุฌุงุจุฉ ุฅูู ููุท ุณุงุฎุฑ
   */
  private makeResponseSarcastic(response: string): string {
    // ุฅุถุงูุฉ ููุณุงุช ูู ุงูุณุฎุฑูุฉ ูุงูููุงูุฉ
    return (
      "# ุญุณูุงูุ ุฅููู ุงูุญูููุฉ ุงููุซูุฑุฉ... ๐\n\n" +
      response
        .replace(/ููู/g, "ููู ููุนุงู ูุงุ ุนูู ูุง ุฃุนุชูุฏ")
        .replace(/ูุฌุจ/g, "ูู ุงูููุชุฑุถ ุฃูู ูุฌุจ")
        .replace(/ุฑุงุฆุน/g, "ูุฐูู ุจุดูู ูุง ูุตุฏู... ุนูู ุงูุฃูู ูุฐุง ูุง ููููููู") +
      "\n\n## ุฎุชุงูุงู...\n\nุขูู ุฃู ูุฐุง ูุงู ูููุฏุงู ุจูุง ููู ุงูููุงูุฉ... ุฃู ุนูู ุงูุฃูู ุฃูุถู ูู ุงูุจุญุซ ูู ุฌูุฌู. ๐"
    )
  }

  /**
   * ุชูุธูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช
   */
  clearCache(): void {
    this.cache.clear()
    console.log("ุชู ุชูุธูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช")
  }

  /**
   * ุชุนููู ุงูุญุฏ ุงูุฃูุตู ูููุนุงูุฌุฉ ุงููุชุฒุงููุฉ
   */
  setMaxConcurrentProcessing(max: number): void {
    this.maxConcurrentProcessing = max
    console.log(`ุชู ุชุนููู ุงูุญุฏ ุงูุฃูุตู ูููุนุงูุฌุฉ ุงููุชุฒุงููุฉ ุฅูู ${max}`)
  }
}

export interface WebSearchResult {
  id: string
  title: string
  url: string
  snippet: string
}

export interface CodeGenerationResult {
  code: string
  language: string
  prompt: string
}
